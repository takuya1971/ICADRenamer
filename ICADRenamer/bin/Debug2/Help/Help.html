<!DOCTYPE html>
<html lang="ja">

<head>
    <title>ICAD Renamer ヘルプ</title>
    <link rel="stylesheet" href="CSS/tocbot.css">
    <meta charset="utf-8" />
</head>

<body>
    <nav class="toc js-toc"></nav>
    <div class="content js-toc-content">
        <h1>ICAD Renamer ヘルプ</h1>
        <hr />
        <section>
            <h2 id="Summery">はじめに</h2>
            <p>
                指定したフォルダ以下にあるICADファイルのM番変更を一括で実行します。<br />
                実行する内容は、以下のとおりです。<br />
                <ol>
                    <li><a>ファイル名とパーツ名の変更</a></li>
                    <li><a>図番の変更</a></li>
                    <li><a>図面日付の変更</a></li>
                    <li><a>署名の変更</a></li>
                    <li><a>訂正記号の削除</a></li>
                    <li><a>訂正注記の削除</a></li>
                    <li><a>図面更新</a></li>
                </ol>
                指定したフォルダのサブフォルダも検索します。<br>
                コピーするファイルは、ICADの図面ファイルのみ、つまり<strong>ファイル名がM番で始まるファイル</strong>のみです。<br>
            </p>
            <hr />
        </section>
        <section>
            <h2 id="Environment">動作環境</h2>
            Windows 10上で動作します。また、ICADが必須です。<br />
            詳細は下記のとおりです。<br />
            <table>
                <thead>
                    <tr>
                        <td>項目</td>
                        <td>必要条件</td>
                    </tr>
                </thead>
                <tr>
                    <td>OS</td>
                    <td>Windows 10</td>
                </tr>
                <tr>
                    <td>メモリ</td>
                    <td>50MB以上</td>
                </tr>
                <tr>
                    <td>ライブラリ</td>
                    <td>.NET FrameWork 4.8</td>
                </tr>
                <tr>
                    <td>ほか</td>
                    <td>ICAD SX<br>
                        ICAD SDK+実行権</td>
                </tr>
            </table>
            <hr />
        </section>
        <section>
            <h2 id="MainScreen">メイン画面</h2>
            <p>
                メイン画面は以下のとおりです。<br />
                ①～④の項目を入力すると、実行できます。<br />
                いずれかに不備があると、実行ボタンは押せません。<br />
            </p>
            <img src="img/MainScreen.PNG" alt="メイン画面" />
            <p id="MainScreenDescription">
                各番号の内容は下記のとおりです。<br />
                <a href="#NewProjectInput">①...新しいM番を入力します。</a><a href="#RegexBox">入力制限</a>をかけることができます。<br />
                <a href="#SignatureInput">②...署名に使う文字を入力します。</a><br />
                <a id="SourceInputBox" href="#SourceFolderInput">③...コピー元のフォルダを指定します。</a><br />
                <a id="DestinationInputBox" href="#DestinationFolderInput">④...コピー先のフォルダを指定します。</a><br />
                <a href="#SourceFolderDialogOpen">⑤...コピー元のフォルダをダイアログで指定します。</a>こっちを使う方が確実です。<br />
                <a href="#DestinationFolderDialogOpen">⑥...コピー先のフォルダをダイアログで指定します。</a>こっちを使う方が確実です。<br />
                <a href="#SourceFilesView">⑦...コピー元のファイルが表示されます。</a><br />
                <a href="#DestinationFilesView">⑧...コピー先のファイルが表示されます。</a><br />
                <a href="#ExecuteButton">⑨...実行ボタンです。</a>変換を実行します。<br />
                <a href="#CancelButton">⑩...変換しないで終了します。</a><br />
                <a href="#OptionSettingDialog">⑪...設定画面</a>を表示します。<br />
                <a href="#RegexScreen">⑫...図面の変換要素を検索する規則</a>の編集画面を表示します。<br />
                <a href="#HelpScreen">⑬...ヘルプ</a>を表示します。<br />
                ⑭...情報ボックスを表示します。<br />
            </p>
            <hr />
            <h3 id="NewProjectInput">新しいM番の入力</h3>
            <p>
                新しいM番は既定では、M○○○○もしくは、MA○○○○○○（いずれも〇は数字)を受け付けます。<br />
                それ以外の文字は受け付けず、他のボックスに移動できません。<br />
                このボックスを飛ばして別のボックスに移動するには、入力した文字を全部削除してください。<br />
            </p>
            <hr />
            <h3 id="SignatureInput">署名に使う文字</h3>
            <p>
                署名に使用する文字を入力します。<br />
                平たく言えばあなたの署名です。<br />
                図面変更の署名欄の変更に使用します。<br />
            </p>
            <hr />
            <h3 id="SourceFolderInput">コピー元フォルダの入力</h3>
            <p>
                コピー元のフォルダを入力します。<br />
                フォルダをコピー&amp;ペーストするときに使用してください。<br />
                通常は、隣のボタンからダイアログを表示した方が直観的で実用的です。<br />
                コピー元フォルダが存在しない場合は、エラーとなって他のボックスへ移動できません。<br />
                このボックスを飛ばして別のボックスに移動するには、入力した文字を全部削除してください。<br />
            </p>
            <hr />
            <h3 id="DestinationFolderInput">コピー先フォルダの入力</h3>
            <p>
                コピー先のフォルダを入力します。<br />
                フォルダをコピー&amp;ペーストするときに使用してください。<br />
                通常は、隣のボタンからダイアログを表示した方が直観的で実用的です。<br />
                コピー元フォルダが存在しない場合は、エラーとなって他のボックスへ移動できません。<br />
                このボックスを飛ばして別のボックスに移動するには、入力した文字を全部削除してください。<br />
            </p>
            <hr />
            <h3 id="SourceFolderDialogOpen">コピー元フォルダのダイアログ</h3>
            <p>
                ボタンを押すと、ダイアログボックスが表示されます。<br />
                フォルダを選択して、OKボタンを押してください。<br />
                <a href="#MainScreen">コピー元ボックス</a>にフォルダのパスが表示されます。<br />
                フォルダがあっても、ICADファイルが存在しないフォルダを選択したときは、エラーになってもう一度ダイアログが開きます。<br />
            </p>
            <img src="img/SourceFolderDialog.png" alt="コピー元フォルダのダイアログ" /><br />
            <hr />
            <h3 id="DestinationFolderDialogOpen">コピー先フォルダのダイアログ</h3>
            <p>
                ボタンを押すと、ダイアログボックスが表示されます。<br />
                フォルダを選択して、OKボタンを押してください。<br />
                <a href="#MainScreen">コピー先ボックス</a>にフォルダのパスが表示されます。<br />
            </p>
            <img src="img/DestinationFolderDialog.png" alt="コピー先フォルダのダイアログ" /><br />
            <hr />
            <h3 id="SourceFilesView">コピー元のファイル</h3>
            <p>
                コピー元フォルダを指定したら、ここにコピー元フォルダ以下のICADファイル名が表示されます。<br />
                ファイルは、指定フォルダのサブフォルダ以下のファイルも表示されます。<br />
                フォルダパスは表示されません。<br />
            </p>
            <hr />
            <h3 id="DestinationFilesView">コピー先のファイル</h3>
            <p>
                コピー元フォルダを指定したら、ここにコピー元フォルダ以下のICADファイル名が表示されます。<br />
                ファイルは、指定フォルダのサブフォルダ以下のファイルも表示されます。<br />
                フォルダパスは表示されません。<br />
                新しく作ったフォルダの場合は、何も表示されません。<br />
            </p>
            <hr />
            <h3 id="ExecuteButton">実行ボタン</h3>
            <p>
                実行可能な状態であるとき、押すことができます。<br />
                押すと<a>実行進捗のウィンドウ</a>が現れ、変換が始まります。<br />
                実行可能な状態は、以下のとおりです。<br />
                <ul>
                    <li><a href="#MainScreen">M番入力ボックス</a>が入力済み。</li>
                    <li><a href="#MainScreen">署名ボックス</a>が入力済み。</li>
                    <li><a href="#MainScreen">コピー元ボックス</a>が入力済み。</li>
                    <li><a href="#MainScreen">コピー先ボックス</a>が入力済み。</li>
                </ul>
            </p>
            <hr />
            <h3 id="CancelButton">終了ボタン</h3>
            <p>
                終了します。<br />
                エラーメッセージが出てこのボタンを押せないときは、ボックスの内容を全部消して押してみてください。<br />
            </p>
            <hr />
        </section>
        <section>
            <h2 id="Operation">基本操作</h2>
            <hr>
            <h3 id="OperationMethod">操作方法</h3>
            <p>

                下記の①～④の項目を入力してOKボタンを押します。<br>
                <img src="img/OperationScreen.png" alt="操作画面"><br>
                <ul>
                    <li>①...<a href="#NewProjectInput">新しいM番を入力します。</a><a href="#RegexBox">入力制限</a>をかけることができます。<br />
                    </li>
                    <li>②...<a href="#SignatureInput">署名</a>に使う文字を入力します。<br /></li>
                    <li>③...<a href="#SourceFolderDialogOpen">コピー元のフォルダをダイアログ</a>で指定します。<br /></li>
                    <li>④...<a href="#DestinationFolderDialogOpen">コピー先のフォルダをダイアログ</a>で指定します。<br /></li>
                    <li>⑤...<a href="#ExecuteButton">実行ボタンです。</a>変換を実行します。</li>
                </ul>
                実行ボタンが灰色の時は実行できません。修正して実行ボタンがカラーになるようにしてください。<br>
            </p>
            <hr>
            <h3 id="Execute">実行</h3>
            <p>
                実行するとICADが立ち上がります。<br>
                実行中は、進行状況が表示されます。<br>
                <img src="img/ExecuteProgressScreen.png" alt="実行中"><br>
                図面数や規模によって時間がかかる場合があります。<br>
                キャンセルボタンを押したとき、反応が遅い場合があります。これは実行中のファイルが完了するのを待つためです。<br>
            </p>
            <hr>
            <h3 id="ExecutionContent">実行内容</h3>
            <p>
                以下の内容をコピー元フォルダ以下のすべてのICADファイルに対して実行します。<br>
                <ul>
                    <li><a href="#PartName">パーツ名変更</a></li>
                    <li><a href="#DrawNumber">図面番号変更</a></li>
                    <li><a href="#DrawingDate">図面日付変更</a></li>
                    <li><a href="#Signature">署名変更</a></li>
                    <li><a href="#DeltaNote">訂正記号と注記の削除</a></li>
                    <li><a href="#DrawingUpdate">図面更新</a></li>
                </ul>
                すべて現在あるものを変更するので、新しくパーツや図番を作ったりはできません。<br>
            </p>
            <hr>
            <h4 id="PartName">パーツ名変更</h4>
            <p>
                パーツ名のM番部分を変更します。<br>
                <a href="#DrawNumberRegex">図番検索規則</a>を使って図番部分を置き換えます。<br>
                子パーツも変更対象で、外部パーツと外部パーツの参照関係も更新します。<br>
                図番が入っていないパーツは実行されません。<br>
            </p>
            <hr>
            <h4 id="DrawNumber">図面番号変更</h4>
            <p>
                <a href="#DrawNumberRegex">図番検索規則</a>を使って図番を置き換えます。<br>
                前方一致で検索します。
            </p>
            <hr>
            <h4 id="DrawingDate">図面日付変更</h4>
            <p>
                <a href="#DateRegex">日付検索規則</a>を使用して、日付を置き換えます。<br>
                日付は完全一致で検索します。<br>
            </p>
            <hr>
            <h4 id="Signature">署名変更</h4>
            <p>
                <a href="#SignatureRegex">署名検索規則</a>リストにある文字を使って、署名を置き換えます。<br>
                完全一致で検索します。<br>
            </p>
            <hr>
            <h4 id="DeltaNote">訂正記号と注記の削除</h4>
            <p>
                デルタ記号を検索して削除します。<br>
                また、<a href="#DeltaNoteRegex">訂正注記規則</a>と<a href="#SignatureRegex">署名規則</a>を使用して、訂正注記を検索し、削除します。<br>
                この項目はOFFにできます。方法は、<a href="#OptionSettingDialog">オプション設定</a>を参照してください。<br>
            </p>
            <hr>
            <h4 id="DrawingUpdate">図面更新</h4>
            <p>
                図面更新を実行します。<br>
                寸法修正は実行しません。<br>
                この項目はOFFにできます。方法は、<a href="#OptionSettingDialog">オプション設定</a>を参照してください。<br>
            </p>
            <hr>
            <h3 id="ExecuteResult">実行結果</h3>
            <p>
                実行結果は、コピー先フォルダにcsvファイルで保存されます。<br>
                ファイル名は、「[コピー元M番]→[コピー先M番]変換結果-ICADRenamer.csv」です。<br>
                途中、失敗してもそのまま実行を続けるので、実行結果は必ず確認してください。<br>
            </p>
            <hr>
        </section>
        <section>
            <h2 id="Attention">変換の注意事項</h2>
            <hr>
            <h3 id="PartNameChangeAttention">パーツ名変更</h3>
            <p>
                パーツ名変更は、既定ではMで始まり、4桁の数字または3桁の数字が続くパーツ名を見つけて、その見つけたパーツ名の部分を、新しいM番に置き換えます。<br>
                したがって、市販部品や図面を見つけているわけではありませんので、おなじルールで始まるパーツは変換してしまいます。これは仕様です。<br>
            </p>
            <hr>
            <h3 id="2D_DrawingChangeAttention">2D図面の変更</h3>
            <p>
                ２D図面の変更は、2D図面内の要素の種類を検索しています。<br>
                検索規則でテキスト要素を検索して一致しているものを探し、内容の一部置き換えを行います。<br>
                したがって、そもそもない要素を作成することはできません。<br>
            </p>
            <hr>
            <h3 id="DrawingUpdateAttention">図面更新</h3>
            <p>
                図面更新は、ICADに対してマクロコマンドを発行しています。<br>
                大規模な図面では「応答なし」状態になることがあります。(ICAD上と同じ)<br>
                図面更新によって発生する可能性がある「寸法のずれ」は修正しません。<br>
            </p>
            <hr>
            <h3>ICADの再起動の可能性</h3>
            <p>
                実行中、とくに図面表題欄の編集中にICADが自動的に再起動することがあります。<br>
                これは、図面開閉を繰り返したときに使用メモリが増大するICADの問題に対応するためです。<br>
            </p>
            <hr>
            <h3>実行中のICADの編集</h3>
            <p>
                実行中は、ICADを操作しないでください。<br>
                操作中の図面を閉じたり、変更を加えたりすると、エラーが発生することがあります。<br>
            </p>
        </section>
        <section>
            <h2 id="OptionSettingDialog">オプション設定</h2>
            <p>
                ICADRenamerのオプションを設定します。<br />
                タブが2つあって、画面が変わります。<br />
                <figure title="オプション設定の全般画面">
                    オプション設定の全般画面<br />
                    <img src="img/OptionSettingDialog1.png" alt="オプション1" /><br />
                </figure>
                <figure title="オプション設定のM番規則画面">
                    オプション設定のM番入力規則画面<br />
                    <img src="img/OptionSettingDialog2.png" /><br />
                </figure>
                各番号の内容は以下のとおりです。<br />
                <ul>
                    <li>①...<a href="#GeneralTab">全般タブです。</a></li>
                    <li>②...<a href="#RegexTab">M番入力規則タブです。</a></li>
                    <li>③...<a href="#PortBox">ICAD連携ポート</a>です。</li>
                    <li>④...<a href="#DefaultFolderBox">初期フォルダ</a>です。</li>
                    <li>⑤...<a href="#UserBox">ユーザー名</a>です。</li>
                    <li>⑥...<a href="#DeltaMarkDeleteCheck">デルタマーク削除</a>チェックボックスです。</li>
                    <li>⑦...<a href="#DrawingUpdateCheck">図面更新</a>チェックボックスです。</li>
                    <li>⑧...<a href="#RegexBox">M番入力規則</a>使用のチェックボックスです。</li>
                    <li>⑨...<a href="#OptionExecuteButton">実行ボタン</a>です。</li>
                    <li>⑩...<a href="#OptionCancelButton">キャンセルボタン</a>です。</li>
                    <li>⑪...<a href="#OptionHelpButton">ヘルプ</a>ボタンです。</li>
                    <li>⑫...<a href="#RegexBox">M番入力規則リスト</a>です。</li>
                    <li>⑬...<a href="#RegexAddNewButton">新規作成ボタン</a>です。</li>
                    <li>⑭...<a href="#RegexDeleteButton">削除ボタン</a>です。</li>
                    <li>⑮...<a href="#ICADMinimize">ICADを最小化</a>するかどうかのチェックボックスです。</li>
                </ul>
            </p>
            <hr />
            <h3 id="GeneralTab">全般タブ</h3>
            <p>
                全般タブです。<br />
                6個の設定ができます。<br />
            </p>
            <hr />
            <h3 id="RegexTab">M番入力規則タブ</h3>
            <p>
                M番入力規則を変更・追加・削除するタブです。<br />
            </p>
            <hr />
            <h3 id="PortBox">ICAD連携ポート</h3>
            <p>
                ICADとの通信を行うポート番号を指定します。<br />
                通常は既定値(3999)のまま使用します。<br />
                既定値ではうまくいかない場合は、変更します。<br />
                この番号を変更したら、ICAD側の番号も変更する必要があります。<br />
                ICAD側の番号変更はICADのマニュアルを参照してください。<br />
            </p>
            <hr />
            <h3 id="DefaultFolderBox">初期フォルダ</h3>
            <p>
                コピー元フォルダの既定値です。<br />
                <a href="#SourceFolderDialogOpen">コピー元とコピー先のフォルダ検索ダイアログ</a>を開いたときの既定のフォルダになります。<br />
            </p>
            <hr />
            <h3 id="UserBox">ユーザー名</h3>
            <p>
                あなたの名前です。<br />
                ここに入力された名前は、<a href="#MainScreen">メイン画面</a>の<a href="#SignatureInput">署名</a>欄の既定値になります。<br />
            </p>
            <hr />
            <h3 id="DeltaMarkDeleteCheck">デルタマーク削除</h3>
            <p>
                図面変更時に、デルタマークを削除するか指定します。<br />
                チェックが入っていると削除します。<br />
                訂正履歴分があるときは一緒に削除されます。<br />
            </p>
            <hr />
            <h3 id="DrawingUpdateCheck">図面更新</h3>
            <p>
                図面変更後、更新処理をするか指定します。<br />
                チェックが入っていると更新を実行します。<br />
                更新処理は、時間がかかることがありますので、場合に応じて使用してください。<br />
            </p>
            <hr />
            <h3 id="RegexBox">M番入力規則</h3>
            <p>
                M番入力規則を追加・編集・削除します。<br />
                M番入力規則は複数登録でき、入力するときにリストのいずれかの形式に合致していれば通ります。<br />
                入力規則文字をダブルクリックすると、編集に、後述の<a href="#RegexAddNewButton">新規作成ボタン</a>を押したときは新規作成になります。<br />
                追加・編集はテスト可能な<a href="#RegexInputScreen">規則入力画面</a>で行います。<br />
                M番入力規則は、<a href="#RegexDescription">正規表現</a>という特殊な形式で行います。<br />
                必ずテストしてから入力してください。<br />
            </p>
            <hr />
            <h3 id="OptionExecuteButton">実行ボタン</h3>
            <p>
                この設定を保存して終了します。<br />
            </p>
            <hr />
            <h3 id="OptionCancelButton">キャンセルボタン</h3>
            <p>
                この設定を保存しないで終了します。<br />
            </p>
            <hr>
            <h3 id="OptionHelpButton">ヘルプボタン</h3>
            <p>
                <a href="#HelpScreen">ヘルプ画面</a>を表示します。<br>
            </p>
            <hr />
            <h3 id="RegexAddNewButton">入力規則新規作成</h3>
            <p>
                新しいM番入力規則を追加します。<br />
                このボタンをクリックすると、テスト可能な<a href="#RegexInputScreen">規則入力画面</a>が現れます。<br />
            </p>
            <hr />
            <h3 id="RegexDeleteButton">入力規則削除ボタン</h3>
            <p>
                選択したM番入力規則を削除します。<br />
                確認ダイアログが現れるので、OKを押すと実際に削除されます。<br />
            </p>
            <hr>
            <h3 id="ICADMinimize">ICAD最小化</h3>
            <p>
                ICADが起動したとき、最小化で起動するか指定します。<br>
                チェックをはずすと、通常のウィンドウサイズで起動します。<br>
            </p>
            <hr />
        </section>
        <section>
            <h2 id="RegexScreen">図面検索キーワード画面</h2>
            <p>
                図面の図番や日付、署名、訂正履歴の文字を検索して置き換えますが、置き換え元のキーワードを登録する画面です。<br />
                <img src="img/RegexScreen.png" alt="図面検索キーワード" /><br />
            </p>
            <p>
                画面の内容は以下のとおりです。<br />
                ①～④のボタンは一つだけ選択でき、選択した内容は、⑤の画面に表示されます。<br />
                ⑤のボックス内の項目をダブルクリックすると、<a href="#RegexInputScreen">規則入力ダイアログ</a>が現れて、編集できます。<br />
                また、新規作成や、削除も可能です。<br />
            </p>
            <ul>
                <li>①...<a href="#DrawNumberRegex">図番検索規則</a>です。</li>
                <li>②...<a href="#DateRegex">日付検索規則</a>です。</li>
                <li>③...<a href="#DeltaNoteRegex">改訂注記検索規則</a>です。</li>
                <li>④...<a href="#SignatureRegex">署名検索規則</a>です。</li>
                <li>⑤...<a href="#ListBox">検索規則リストボックス</a></li>
                <li>⑥...検索規則を<a href="#KeywordAddNew">新規作成</a>します。</li>
                <li>⑦...選択した検索規則を<a href="#KeywordDeleteItem">削除</a>します。</li>
                <li>⑧...この設定を<a href="#KeywordSave">保存</a>します。</li>
                <li>⑨...<a href="#KeywordAccept">設定を保存して終了</a>します。</li>
                <li>⑩...<a href="#KeywordCancel">キャンセルボタン</a>です。</li>
                <li>⑪...<a href="#RegexHelpButton">ヘルプボタン</a>です。</li>
            </ul>
            <hr />
            <h3 id="RegexSelect">検索規則の選択</h3>
            <p>
                編集する検索規則を選択します。<br />
                ①～④のうち、ひとつを選択すると、右の⑤の内容が変化します。<br />
            </p>
            <hr />
            <h4 id="DrawNumberRegex">図番検索規則</h4>
            <p>
                図面の図番テキスト要素を検索する規則です。<br />
                検索は前方一致で判定します。<br />
            </p>
            <hr />
            <h4 id="DateRegex">日付検索規則</h4>
            <p>
                図面の日付テキスト要素を検索する規則です。<br />
                検索は完全一致で判定します。<br />
            </p>
            <hr />
            <h4 id="DeltaNoteRegex">改訂注記検索規則</h4>
            <p>
                図面の改訂注記テキスト要素を検索する規則です。<br />
                このあとに、④の署名リストの名前を追加して検索します。<br />
                検索は後方一致で判定します。<br />
            </p>
            <hr />
            <h4 id="SignatureRegex">署名検索規則</h4>
            <p>
                図面の署名テキスト要素を検索する規則です。<br />
                検索は完全一致で判定します。<br />
            </p>
            <hr />
            <h3 id="ListBox">検索規則リストボックス</h3>
            <p>
                選択した規則の一覧が表示されます。<br />
                項目をダブルクリックすると<a href="#RegexInputScreen">規則入力ダイアログ</a>が立ち上がり、編集できます。<br />
                また、右クリックメニューでも編集・追加・削除ができます。<br />
            </p>
            <hr />
            <h3 id="KeywordAddNew">新規作成ボタン</h3>
            <p>
                新しい規則を追加できます。<br />
                押すと、<a href="#RegexInputScreen">規則入力ダイアログ</a>が立ち上がります。<br />
            </p>
            <hr />
            <h3 id="KeywordDeleteItem">削除ボタン</h3>
            <p>
                項目を選択して、押すと選択した項目を削除します。<br />
                確認メッセージが出るので、OKすると削除されます。<br />
            </p>
            <hr />
            <h3 id="KeywordSave">保存ボタン</h3>
            <p>
                変更した内容を保存します。<br />
            </p>
            <hr />
            <h3 id="KeywordAccept">更新ボタン</h3>
            <p>
                変更した内容を保存して終了します。<br />
            </p>
            <hr />
            <h3 id="KeywordCancel">キャンセルボタン</h3>
            <p>
                変更した内容を保存せず終了します。<br />
            </p>
            <hr>
            <h3 id="RegexHelpButton">ヘルプボタン</h3>
            <p>
                <a href="#HelpScreen">ヘルプ画面</a>を表示します。<br>
            </p>
            <hr>
        </section>
        <section>
            <h2 id="HelpScreen">ヘルプ画面</h2>
            <p>
                ヘルプ表示用の簡易ブラウザです。<br>
                <img src="img/HelpScreen.png" alt="ヘルプ画面"><br>
                下記は各ボタンの説明です。<br>
                <ul>
                    <li>①...<a href="#GoBackButton">戻るボタン</a></li>
                    <li>②...<a href="#GoForwardButton">進むボタン</a></li>
                    <li>③...<a href="#HelpHomeButton">ホームボタン</a></li>
                    <li>④...<a href="#HelpUpdateButton">更新ボタン</a></li>
                </ul>
            </p>
            <hr>
            <h3 id="GoBackButton">戻るボタン</h3>
            <p>
                ひとつ前の項目へ戻ります。<br>
                戻れないときは灰色です。<br>
            </p>
            <hr>
            <h3 id="GoForwardButton">進むボタン</h3>
            <p>
                ひとつ次の項目進みます。<br>
                進めないときは灰色です。<br>
            </p>
            <hr>
            <h3 id="HelpHomeButton">ホームボタン</h3>
            <p>
                この画面が呼び出された項目へ移動します。<br>
                たとえば、<a href="#OptionSettingDialog">オプション設定画面</a>から呼び出されたら、オプション画面の項目がホームになります。<br>
                <a href="#MainScreen">メイン画面</a>から呼び出されたら、メイン画面がホームです。<br>
            </p>
            <hr>
            <h3 id="HelpUpdateButton">更新ボタン</h3>
            <p>
                画面の表示が止まった時など、押すと改善される可能性があります。<br>
            </p>
            <hr />
        </section>
        <section>
            <h2 id="RegexInputScreen">規則入力ダイアログ</h2>
            <p>
                正規表現の規則の入力画面です。<br />
                <img src="img/RegexInputScreen.png" alt="検索規則入力" /><br />
                <ul>
                    <li>①...<a href="#Regex">検索規則</a>を<a href="#RegexDescription">正規表現</a>で入力します。</li>
                    <li>②...<a href="#TestCategory">テスト区分</a>の選択</li>
                    <li>③...<a href="#InputString">入力文字列</a></li>
                    <li>④...<a href="#ReplaceString">置換文字列</a></li>
                    <li>⑤...<a href="#Result">テスト結果</a></li>
                    <li>⑥...<a href="#TestButton">テストボタン</a></li>
                    <li>⑦...<a href="#RegexInputAccept">OKボタン</a></li>
                    <li>⑧...<a href="#RegexInputCancel">キャンセルボタン</a></li>
                    <li>⑨...<a href="#InputHelpButton">ヘルプボタン</a></li>
                </ul>
            </p>
            <hr />
            <h3 id="Regex">検索規則</h3>
            規則を入力します。<a href="#RegexDescription">正規表現</a>で入力します。<br>
            <a
                href="https://docs.microsoft.com/ja-jp/dotnet/standard/base-types/regular-expression-language-quick-reference#anchors">アンカー</a>は使用しないで下さい。<br>
            <hr />
            <h3 id="TestCategory">テスト区分</h3>
            <p>

                テスト内容を選択します。<br>
                変更する規則の内容によって選択肢が変わります。<br>
                選択肢は以下のとおりです。<br>
                <ul>
                    <li><a href="#RegexMatch">一致判断</a></li>
                    <li><a href="#RegexReplace">置き換え</a></li>
                    <li><a href="#RegexFilter">一致抽出</a></li>
                </ul>
            </p>
            <hr>
            <h4 id="RegexMatch">一致判断</h4>
            <p>
                <a href="#Regex">検索規則</a>と一致するかを判断します。<br>
                この項目のときは、<a href="#RegexReplace">置換文字列</a>は入力しません。<br>
                <a href="#Regex">検索規則</a>と<a href="#InputString">入力文字列</a>を入力して、<a href="#TestButton">テストボタン</a>を押すと、<a
                    href="#Result">テスト結果</a>が表示されます。<br>
                結果は「一致」または「不一致」と表示されます。<br>
            </p>
            <hr>
            <h4 id="RegexReplace">置き換え</h4>
            <p>
                <a href="#InputString">入力文字列</a>で入力した文字列に<a href="#Regex">検索規則</a>が一致する箇所に<a
                    href="#ReplaceString">置換文字列</a>に置き換えます。<br>
                上の3項目を入力して、<a href="#TestButton">テストボタン</a>を押すと、<a href="#Result">テスト結果</a>が表示されます。<br>
                置換した文字列は、<a href="#Result">テスト結果</a>に表示されます。<br>
            </p>
            <hr>
            <h4 id="RegexFilter">一致抽出</h4>
            <p>
                <a href="#InputString">入力文字列</a>で入力した文字列から、<a href="#Regex">検索規則</a>で一致した項目を抽出します。<br>
                上の2項目を入力して、<a href="#TestButton">テストボタン</a>を押すと、<a href="#Result">テスト結果</a>が表示されます。<br>
                抽出した文字列は、<a href="#Result">テスト結果</a>に表示されます。<br>
            </p>
            <hr />
            <h3 id="InputString">入力文字列</h3>
            <p>
                テストする元になる文字列です。<br>
            </p>
            <hr />
            <h3 id="ReplaceString">置換文字列</h3>
            <p>
                <a href="#TestCategory">テスト区分</a>が<a href="#RegexReplace">置き換え</a>のときに使用します。<br>
                <a href="#InputString">入力文字列</a>を<a href="#Regex">検索規則</a>で検索して、一致した項目をこの文字で置き換えます。<br>
            </p>
            <hr />
            <h3 id="Result">テスト結果</h3>
            <p>
                <a href="#TestButton">テストボタン</a>を押すと、結果が表示されます。<br>
                <a href="#RegexMatch">一致判断</a>では「一致」または「不一致」が、<br>
                <a href="#RegexReplace">置き換え</a>では、<a href="#InputString">入力文字列</a>を<a
                    href="#ReplaceString">置換文字列</a>で置き換えた文字列が、<br>
                <a href="#RegexFilter">一致抽出</a>では、<a href="#InputString">入力文字列</a>から、一致した文字列を表示します。<br>
            </p>
            <hr />
            <h3 id="TestButton">テストボタン</h3>
            <p>
                テストを開始します。<br>
                結果は、<a href="#Result">テスト結果</a>に表示されます。<br>
            </p>
            <hr>
            <h3 id="RegexInputAccept">OKボタン</h3>
            <p>
                結果が良好なら、このボタンを押して、入力を完了します。<br>
            </p>
            <hr>
            <h3 id="RegexInputCancel">キャンセルボタン</h3>
            <p>
                入力をキャンセルして終了します。<br>
            </p>
            <hr>
            <h3 id="InputHelpButton">ヘルプボタン</h3>
            <p>
                <a href="#RegexDescription">正規表現</a>に関する<a href="#HelpScreen">ヘルプ画面</a>を表示します。<br>
                専用のブラウザフォームで表示します。<br>
            </p>
            <hr />
        </section>
        <section>
            <h2 id="Tooltip">ツールチップ</h2>
            <p>
                画面上でボタンや文字にマウスカーソルを合わせると、簡単な説明（ツールチップ）が表示されます。<br>
                <img src="img/ToolTip.png" alt="ツールチップ"><br>
            </p>
            <hr>
        </section>
        <section>
            <h2 id="ConsoleMode">コマンドライン</h2>
            <p>
                コマンドラインを設定できます。
            </p>
            <table>
                <thead>
                    <tr>
                        <th>コマンド</th>
                        <th>別名</th>
                        <th>引数</th>
                        <th>内容</th>
                    </tr>
                </thead>
                <tr>
                    <td>-Console</td>
                    <td>-c</td>
                    <td>なし</td>
                    <td>コンソール付モードで立上ます。</td>
                </tr>
                <tr>
                    <td>-Debug</td>
                    <td>-d</td>
                    <td>なし</td>
                    <td>デバッグモードで立上ます。</td>
                </tr>
                <tr>
                    <td>-Silent</td>
                    <td>-s</td>
                    <td>[コピー元フォルダ],[コピー先フォルダ],[新しいM番],[署名]</td>
                    <td>コマンドラインから変換を実行します。</td>
                </tr>
                <tr>
                    <td>-Help</td>
                    <td>-?</td>
                    <td>なし</td>
                    <td>コンソールにヘルプを表示します。</td>
                </tr>
            </table>
            いずれも、コマンドプロンプトから実行します。<br>
            <hr>
        </section>
        <section>
            <h2 id="RegexDescription">正規表現について</h2>
            <hr />
            <h3 id="RegexGeneral">一般的な正規表現</h3>
            <p>
                正規表現は、テキストの解析や検索に使われるパターンマッチングの手法です。<br />
                一般的な解釈は、<a
                    href="https://ja.wikipedia.org/wiki/%E6%AD%A3%E8%A6%8F%E8%A1%A8%E7%8F%BE">Wikipedia</a>を参照してください。<br />
                また、ICADRenamerが実際に解析するのは、<a
                    href="https://docs.microsoft.com/ja-jp/dotnet/standard/base-types/regular-expressions">Microsoft</a>のものを参照してください。<br />
                以下に、正規表現の一部の説明を載せます。
                <table>
                    <thead>
                        <tr>
                            <th>文字</th>
                            <th>説明</th>
                            <th>例</th>
                        </tr>
                    </thead>
                    <tr>
                        <td>{ }</td>
                        <td>直前の文字の繰り返し回数を表します。</td>
                        <td>[0-9]{3}は「000から999」までとなります。<br />また、a{4}だと、「aaaa」になります。</td>
                    </tr>
                    <tr>
                        <td>[0-9]</td>
                        <td>1桁の数字を表します。</td>
                        <td>M[0-9]{3}は「M000からM999」までとなります。</td>
                    </tr>
                    <tr>
                        <td>|</td>
                        <td>または、を表します。論理演算のORと同義です。</td>
                        <td>M|MA　は、「MまたはMA」となります。</td>
                    </tr>
                    <tr>
                        <td>(...)</td>
                        <td>条件のくくりを表します。</td>
                        <td>(The|a) pen　は、「The pen」または「a pen」となります。</td>
                    </tr>
                    <tr>
                        <td>{n,}</td>
                        <td>直前の文字がn回以上出現することを表します。</td>
                        <td>a{2,}はaが2回以上連続しています。<br>aa,aaa,aaaa・・・など。</td>
                    </tr>
                </table>
                他にもたくさんありますが、ここで使用するのは上のものくらいと思います。<br />
                また、同じ意味の違う表現も可能です。<br />
                <h3 id="DefaultRegex">既定値で使用されている正規表現</h3>
                <table>
                    <thead>
                        <tr>
                            <th>使用場所</th>
                            <th>文字</th>
                            <th>説明</th>
                        </tr>
                    </thead>
                    <tr>
                        <td>M番入力規則</td>
                        <td>M[0-9]{4}</td>
                        <td>「M」のあとに4桁の数字が続きます。<br />M0000～M9999</td>
                    </tr>
                    <tr>
                        <td>M番入力規則</td>
                        <td>MA[0-9]{6}</td>
                        <td>「MA」のあとに6桁の数字が続きます。<br />MA000000～MA999999まで。</td>
                    </tr>
                    <tr>
                        <td>図番検索要素</td>
                        <td>(M[0-9]{4}|M[0-9]{3})-([0-9]{4}|[0-9]{3})-[0-9]{2}</td>
                        <td>たとえば、以下のものです。<br />
                            M123-456-78<br />
                            M123-4567-89<br />
                            M1234-567-89<br />
                            M0123-4567-89<br />
                            この項目は前方一致です。</td>
                    </tr>
                    <tr>
                        <td>日付検索要素</td>
                        <td>([0-9]{4}|[0-9]{2})(/|.)([0-9]{2}|[0-9])(/|.)([0-9]{2}|[0-9])</td>
                        <td>たとえば、以下のものです。<br />
                            2020.1.2<br />
                            2020.12.23<br />
                            2020.1.23<br />
                            2020.12.3<br />
                            20.1.2<br />
                            20.12.3<br />
                            20.12.23<br />
                            上の「.」は「/」でも可。</td>
                    </tr>
                    <tr>
                        <td>改訂注記検索要素</td>
                        <td>．{3,}</td>
                        <td>「.」（ドット）が3個以上</td>
                    </tr>
                    <tr>
                        <td>改訂注記検索要素</td>
                        <td>・{3,}</td>
                        <td>「・」（中点）が3個以上</td>
                    </tr>
                </table>
            </p>
            <hr>
        </section>
        <section>
            <h2 id="LogViewer">ログビューワ</h2>
            <p>
                ICAD Renamerの専用ログビューワです。<br>
                ICAD Renamerと同じフォルダに入っている単独のアプリケーションです。<br>
                ログを表形式で表示します。<br>
                既定では、インストールフォルダのLogフォルダの内容を表示しています。<br>
                ③のファイル選択の矢印をクリックすると日付が選択でき、その日付の内容が表示されます。<br>
                また、表示するログのレベルは、④で抽出することができます。<br>
                <img src="img/LogViewer.png" alt="ログビューワ画面" /><br>
                下記は各ボタンの説明です。
                <ul>
                    <li>①...<a href="#FolderBrowseButton">フォルダを開くボタン</a>です。</li>
                    <li>②...選択している<a href="#SaveFileButton">ファイルを保存</a>します。</li>
                    <li>③...表示する<a href="#FileSelect">ファイルを選択</a>します。</li>
                    <li>④...<a href="#LevelFilter">レベルフィルタ</a>です。</li>
                    <li>⑤...<a href="#LogViewerHelpButton">ヘルプボタン</a>です。</li>
                    <li>⑥...<a href="#CloseButton">終了ボタン</a>です。</li>
                </ul>
            </p>
            <hr>
            <h3 id="FolderBrowseButton">フォルダ選択ボタン</h3>
            <p>
                既定のフォルダではなく、他のフォルダを選択します。<br>
                ログファイルのないフォルダを選択するとエラーになり、フォルダ選択に戻ります。<br>
            </p>
            <hr>
            <h3 id="SaveFileButton">保存ボタン</h3>
            <p>
                今選択しているファイルを、名前を付けて保存します。<br>
                ダイアログが表示されますので、選択して保存します。<br>
            </p>
            <hr>
            <h3 id="FileSelect">ファイル選択</h3>
            <p>
                ログは1日を単位とするテキストファイルになっています。<br>
                ドロップダウンして、日付を選択すると、表示される内容が変わります。<br>
            </p>
            <hr>
            <h3 id="LevelFilter">レベルフィルタ</h3>
            <p>
                表示されているログをログレベルでフィルタします。<br>
                行のないレベルは表示されません。<br>
            </p>
            <hr>
            <h3 id="LogViewerHelpButton">ヘルプボタン</h3>
            <p>
                <a href="#HelpScreen">ヘルプブラウザ</a>でヘルプを表示します。<br>
            </p>
            <hr>
            <h3 id="CloseButton">終了ボタン</h3>
            <p>
                ログビューワを終了します。<br>
            </p>
            <hr>
        </section>
        <section>
            <h2 id="Library">ライブラリなど</h2>
            <p>以下のライブライを使用しています。</p>
            <table>
                <thead>
                    <tr>
                        <th>名称</th>
                        <th>作者</th>
                        <th>ライセンス</th>
                    </tr>
                </thead>
                <tr>
                    <td>NLog</td>
                    <td>Copyright (c) 2004-2019 Jaroslaw Kowalski &lt;jaak@jkowalski.net&gt;, Kim Christensen, Julian
                        Verdurmen</td>
                    <td>
                        BSD 3-Clause "New" or "Revised" License</td>
                </tr>
                <tr>
                    <td>CSVHelper</td>
                    <td>Copyright &copy; 2009-2018 Josh Close and Contributors</td>
                    <td>Dual licensing under MS-PL and Apache 2.0</td>
                </tr>
                <tr>
                    <td>Newtonsoft.Json</td>
                    <td>Copyright &copy; James Newton-King 2008</td>
                    <td>MIT License</td>
                </tr>
                <tr>
                    <td>Ookii.Commandline</td>
                    <td>Copyright &copy; Sven Groot(Ookii.org)</td>
                    <td>Microsoft Public License</td>
                </tr>
                <tr>
                    <td>Microsoft.Toolkit.Forms.UI.Controls.WebView</td>
                    <td>Copyright (c) .NET Foundation and Contributors</td>
                    <td>MIT License (MIT)</td>
                </tr>
                <tr>
                    <td>Microsoft.Toolkit.Forms.UI.Controls</td>
                    <td>Copyright (c) .NET Foundation and Contributors</td>
                    <td>MIT License (MIT)</td>
                </tr>
                <tr>
                    <td>tocbot</td>
                    <td>Copyright (c) 2016 Tim Scanlin</td>
                    <td>The MIT License (MIT)</td>
                </tr>
                <tr>
                    <td>sxnet</td>
                    <td>&copy; 2009 iCAD LIMITED. All rights reserved.</td>
                    <td>プロプライエタリ</td>
                </tr>
            </table>
        </section>
        <footer>
            <hr>
            ICAD Renamer ver.1.0.0.0<br>
            <hr>
        </footer>
    </div>
    <!--Scrpit-->
    <script src="../Scripts/tocbot-master/dist/tocbot.min.js"></script>
    <script>
        (function () {
            "use strict;"
            tocbot.init({
                // Where to render the table of contents.
                tocSelector: '.js-toc',
                // Where to grab the headings to build the table of contents.
                contentSelector: '.js-toc-content',
                // Which headings to grab inside of the contentSelector element.
                headingSelector: 'h2, h3, h4',
                // For headings inside relative or absolute positioned containers within content.
                hasInnerContainers: true,
            });
        })();
    </script>
</body>

</html>